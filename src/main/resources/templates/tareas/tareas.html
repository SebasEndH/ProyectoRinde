<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title th:text="${titulo}">Tareas</title>
    <link th:href="@{/CSS/style.css}" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <style>
      /* Ajustes mínimos visuales */
      #tareasApp { max-width: 1100px; margin: 4rem auto; }
      .task-desc { display:block; color:#6c757d; font-size:0.95rem; }
      .card-header .btn { float: right; }
      .empty-placeholder { color:#6c757d; font-style: italic; padding: 1.25rem; }
      .footer { bottom: 0; position: fixed; padding: 1rem; width: 100%; text-align: center; }
    </style>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link th:href="@{/img/icon.svg}" rel="shortcut icon" />
  </head>
  <body>
    <div th:replace="fragments/navbar :: navbar-principal"></div>

    <div id="tareasApp" class="container">
      <div class="row align-items-start">
        <div class="col-12">
          <h1 class="mt-4 mb-3">Gestión de Tareas</h1>
        </div>

        <!-- Formulario (izquierda en pantallas grandes) -->
        <div class="col-12 col-lg-4 mb-3">
          <div class="card shadow-sm">
            <div class="card-header d-flex align-items-center">
              <strong class="me-auto">Nueva tarea</strong>
            </div>
            <div class="card-body">
              <form th:action="@{/tareas}" method="post" class="row g-2">
                <div class="col-12 mb-2">
                  <label for="nombreInput" class="form-label small">Nombre</label>
                  <input id="nombreInput" name="nombre" class="form-control" placeholder="Nombre de la tarea" required />
                </div>
                <div class="col-12 mb-2">
                  <label for="descripcionInput" class="form-label small">Descripción</label>
                  <input id="descripcionInput" name="descripcion" class="form-control" placeholder="Descripción (opcional)" />
                </div>
                <div class="col-12">
                  <button class="btn btn-primary w-100" type="submit">
                    <i class="bi bi-plus-lg me-1"></i> Agregar tarea
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Lista (derecha en pantallas grandes) -->
        <div class="col-12 col-lg-8 mb-3">
          <div class="card shadow-sm">
            <div class="card-header d-flex align-items-center">
              <strong class="me-auto">Tareas</strong>
              <span id="taskCountBadge" class="badge bg-secondary ms-2" th:text="${#lists.size(tareas)}">0</span>
            </div>
            <div class="card-body p-0">
              <ul id="taskList" class="list-group list-group-flush">
                <!-- Render inicial desde servidor -->
                <li th:each="tarea : ${tareas}" class="list-group-item d-flex justify-content-between align-items-start">
                  <div>
                    <div><strong th:text="${tarea.nombre}">Nombre</strong></div>
                    <div class="task-desc" th:text="${tarea.descripcion}">Descripción</div>
                  </div>
                  <div class="ms-3">
                    <form th:action="@{/tareas/eliminar}" method="post" th:object="${tarea}">
                      <input type="hidden" name="nombre" th:value="${tarea.nombre}" />
                      <button type="submit" class="btn btn-sm btn-outline-danger">
                        <i class="bi bi-trash"></i>
                      </button>
                    </form>
                  </div>
                </li>

                <!-- Placeholder si no hay tareas -->
                <li id="emptyPlaceholder" th:if="${#lists.isEmpty(tareas)}" class="list-group-item">
                  <div class="empty-placeholder">No hay tareas aún. Agrega la primera tarea usando el formulario.</div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--Footer-->
    <footer class="footer bg-dark text-white text-center py-3">
      <p class="mb-0">2025 Rinde. Todos los derechos reservados</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/JS/script.js}"></script>
  </body>
</html>
